<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Heure Calculator - by dera</title>
<style>
body{
    background:#0f172a;
    color:white;
    font-family:Arial;
    text-align:center;
}
input{
    padding:8px;
    margin:5px;
    border-radius:8px;
    border:none;
}
button{
    padding:10px 20px;
    border:none;
    border-radius:10px;
    background:#22c55e;
    color:white;
    font-weight:bold;
    margin:5px;
}
#result{
    font-size:22px;
    margin-top:15px;
    color:#facc15;
}
#history{
    margin-top:20px;
    max-height:200px;
    overflow:auto;
    background:#111827;
    padding:10px;
    border-radius:10px;
}
.historyItem{
    font-size:14px;
    margin:5px 0;
    border-bottom:1px solid #1f2937;
    padding-bottom:5px;
}
</style>
</head>
<body>

<h2>HEURE CALCULATOR</h2>
<p>by dera</p>

<label>Heure de départ :</label><br>
<input type="datetime-local" id="heureDepart"><br>

<label>Hash :</label><br>
<input type="text" id="hashInput" placeholder="Ampidiro hash"><br>

<button onclick="calculate()">CALCULER</button>
<button onclick="clearHistory()">CLEAR HISTORIQUE</button>

<div id="result">
Résultat finale : --
</div>

<div id="history">
<h3>Historique</h3>
<div id="historyList"></div>
</div>

<script>

// Auto remplir heure actuelle
document.getElementById("heureDepart").value =
new Date().toISOString().slice(0,16);

// SHA-256
async function sha256(message){
const msgBuffer = new TextEncoder().encode(message);
const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
const hashArray = Array.from(new Uint8Array(hashBuffer));
return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
}

async function calculate(){

let heure = document.getElementById("heureDepart").value;
let hash = document.getElementById("hashInput").value;

if(hash=="") hash="defaultHash";

let mix = hash + heure;
let hashed = await sha256(mix);

// Hex 3 isa
let hex3 = hashed.substring(0,3);
let decimal = parseInt(hex3,16);

// Offset minute max 255
let offsetMinute = decimal % 256;

let date = new Date(heure);
date.setMinutes(date.getMinutes() + offsetMinute);

let finalHeure = date.toLocaleTimeString();

document.getElementById("result").innerHTML =
"Hex(3): " + hex3.toUpperCase() +
"<br>Minutes ajoutées: " + offsetMinute +
"<br>Résultat finale: " + finalHeure;

// Ajouter historique
let historyList = document.getElementById("historyList");
let item = document.createElement("div");
item.className = "historyItem";
item.innerHTML =
"[" + new Date().toLocaleTimeString() + "] → "
+ finalHeure +
" (Hex: " + hex3.toUpperCase() + ")";
historyList.prepend(item);

}

// Clear historique
function clearHistory(){
document.getElementById("historyList").innerHTML="";
}

</script>

</body>
</html>
